{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","ComponentManager","permissions","onReady","sentMessages","messageQueue","loggingEnabled","onReadyCallback","window","addEventListener","event","console","log","data","handleMessage","bind","payload","action","sessionKey","componentData","activateThemes","themes","original","originalMessage","filter","message","messageId","callback","postMessage","key","value","push","generateUUID","api","sentMessage","JSON","parse","stringify","parent","type","width","height","content_types","tags","items","item","jsonObjectForItem","associateItem","content_type","deleteItems","params","map","saveItems","copy","Object","assign","children","urls","deactivateAllCustomThemes","url","link","document","createElement","href","rel","media","className","getElementsByTagName","appendChild","elements","getElementsByClassName","forEach","element","disabled","parentNode","removeChild","crypto","msCrypto","buf","Uint32Array","getRandomValues","idx","replace","c","v","toString","d","Date","getTime","performance","now","uuid","Math","random","floor","angular","HomeCtrl","$rootScope","$scope","$timeout","delimitter","name","componentManager","formData","defaultHeight","tagsInputChange","$event","input","lastTag","split","slice","results","tag","comps","content","title","comp","startsWith","sort","b","showAutocomplete","highlightTag","show","setSize","documentElement","scrollHeight","selectTag","index","tagName","join","_tag","candidate","highlightedTag","removeActiveTag","deassociateItem","streamItems","newTags","allTags","existing","tagCandidate","streamContextItem","matchingReference","references","ref","activeTags","highlightNextResult","indexOf","highlighResultAtIndex","highlightPreviousResult","onEnter","createItem","onkeydown","handleArrowKey","keyCode","$$ngIsClass","controller"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nclass ComponentManager {\n\n  constructor(permissions, onReady) {\n    this.sentMessages = [];\n    this.messageQueue = [];\n    this.permissions = permissions;\n    this.loggingEnabled = false;\n    this.onReadyCallback = onReady;\n\n    window.addEventListener(\"message\", function (event) {\n      if (this.loggingEnabled) {\n        console.log(\"Components API Message received:\", event.data);\n      }\n      this.handleMessage(event.data);\n    }.bind(this), false);\n  }\n\n  handleMessage(payload) {\n    if (payload.action === \"component-registered\") {\n      this.sessionKey = payload.sessionKey;\n      this.componentData = payload.componentData;\n      this.onReady();\n\n      if (this.loggingEnabled) {\n        console.log(\"Component successfully registered with payload:\", payload);\n      }\n    } else if (payload.action === \"themes\") {\n      this.activateThemes(payload.data.themes);\n    } else if (payload.original) {\n      // get callback from queue\n      var originalMessage = this.sentMessages.filter(function (message) {\n        return message.messageId === payload.original.messageId;\n      })[0];\n\n      if (originalMessage.callback) {\n        originalMessage.callback(payload.data);\n      }\n    }\n  }\n\n  onReady() {\n    for (var message of this.messageQueue) {\n      this.postMessage(message.action, message.data, message.callback);\n    }\n    this.messageQueue = [];\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n\n  setComponentDataValueForKey(key, value) {\n    this.componentData[key] = value;\n    this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n  }\n\n  clearComponentData() {\n    this.componentData = {};\n    this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n  }\n\n  componentDataValueForKey(key) {\n    return this.componentData[key];\n  }\n\n  postMessage(action, data, callback) {\n    if (!this.sessionKey) {\n      this.messageQueue.push({\n        action: action,\n        data: data,\n        callback: callback\n      });\n      return;\n    }\n\n    var message = {\n      action: action,\n      data: data,\n      messageId: this.generateUUID(),\n      sessionKey: this.sessionKey,\n      permissions: this.permissions,\n      api: \"component\"\n    };\n\n    var sentMessage = JSON.parse(JSON.stringify(message));\n    sentMessage.callback = callback;\n    this.sentMessages.push(sentMessage);\n\n    if (this.loggingEnabled) {\n      console.log(\"Posting message:\", message);\n    }\n\n    window.parent.postMessage(message, '*');\n  }\n\n  setSize(type, width, height) {\n    this.postMessage(\"set-size\", { type: type, width: width, height: height }, function (data) {});\n  }\n\n  streamItems(callback) {\n    this.postMessage(\"stream-items\", { content_types: [\"Tag\"] }, function (data) {\n      var tags = data.items;\n      callback(tags);\n    }.bind(this));\n  }\n\n  streamContextItem(callback) {\n    this.postMessage(\"stream-context-item\", null, function (data) {\n      var item = data.item;\n      callback(item);\n    }.bind(this));\n  }\n\n  selectItem(item) {\n    this.postMessage(\"select-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  createItem(item) {\n    this.postMessage(\"create-item\", { item: this.jsonObjectForItem(item) }, function (data) {\n      var item = data.item;\n      this.associateItem(item);\n    }.bind(this));\n  }\n\n  associateItem(item) {\n    this.postMessage(\"associate-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  deassociateItem(item) {\n    this.postMessage(\"deassociate-item\", { item: this.jsonObjectForItem(item) });\n  }\n\n  clearSelection() {\n    this.postMessage(\"clear-selection\", { content_type: \"Tag\" });\n  }\n\n  deleteItem(item) {\n    this.deleteItems([item]);\n  }\n\n  deleteItems(items) {\n    var params = {\n      items: items.map(function (item) {\n        return this.jsonObjectForItem(item);\n      }.bind(this))\n    };\n    this.postMessage(\"delete-items\", params);\n  }\n\n  saveItem(item) {\n    this.saveItems([item]);\n  }\n\n  saveItems(items) {\n    items = items.map(function (item) {\n      return this.jsonObjectForItem(item);\n    }.bind(this));\n\n    this.postMessage(\"save-items\", { items: items }, function (data) {});\n  }\n\n  jsonObjectForItem(item) {\n    var copy = Object.assign({}, item);\n    copy.children = null;\n    copy.parent = null;\n    return copy;\n  }\n\n  /* Themes */\n\n  activateThemes(urls) {\n    this.deactivateAllCustomThemes();\n\n    if (this.loggingEnabled) {\n      console.log(\"Activating themes:\", urls);\n    }\n\n    if (!urls) {\n      return;\n    }\n\n    for (var url of urls) {\n      if (!url) {\n        continue;\n      }\n\n      var link = document.createElement(\"link\");\n      link.href = url;\n      link.type = \"text/css\";\n      link.rel = \"stylesheet\";\n      link.media = \"screen,print\";\n      link.className = \"custom-theme\";\n      document.getElementsByTagName(\"head\")[0].appendChild(link);\n    }\n  }\n\n  deactivateAllCustomThemes() {\n    var elements = document.getElementsByClassName(\"custom-theme\");\n\n    [].forEach.call(elements, function (element) {\n      if (element) {\n        element.disabled = true;\n        element.parentNode.removeChild(element);\n      }\n    });\n  }\n\n  /* Utilities */\n\n  generateUUID() {\n    var crypto = window.crypto || window.msCrypto;\n    if (crypto) {\n      var buf = new Uint32Array(4);\n      crypto.getRandomValues(buf);\n      var idx = -1;\n      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        idx++;\n        var r = buf[idx >> 3] >> idx % 8 * 4 & 15;\n        var v = c == 'x' ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n      });\n    } else {\n      var d = new Date().getTime();\n      if (window.performance && typeof window.performance.now === \"function\") {\n        d += performance.now(); //use high-precision timer if available\n      }\n      var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c == 'x' ? r : r & 0x3 | 0x8).toString(16);\n      });\n      return uuid;\n    }\n  }\n}\n\nwindow.ComponentManager = ComponentManager;\n\n\n},{}]},{},[1]);\n;'use strict';\n\nangular.module('app', [\n\n])\n;class HomeCtrl {\n  \n  constructor($rootScope, $scope, $timeout) {\n\n\n    $scope.tags = [];\n\n    var delimitter = \".\";\n\n    var permissions = [\n      {\n        name: \"stream-items\",\n        content_types: [\"Tag\"]\n      },\n      {\n        name: \"stream-context-item\"\n      }\n    ]\n\n    let componentManager = new window.ComponentManager(permissions, function(){\n      // on ready\n    });\n\n    $scope.formData = {};\n    let defaultHeight = 50;\n\n    $scope.tagsInputChange = function($event) {\n      var input = $scope.formData.input;\n\n      var lastTag = input.split(\"#\").slice(-1)[0];\n      if(lastTag) {\n        $scope.results = $scope.tags.filter(function(tag){\n          var comps = tag.content.title.split(delimitter);\n          for(var comp of comps) {\n            if(comp.length && comp.startsWith(lastTag)) {\n              return true;\n            }\n          }\n          return tag.content.title.startsWith(lastTag);\n        }).sort(function(a, b){\n          return a.content.title > b.content.title;\n        })\n      } else {\n        $scope.results = [];\n      }\n\n      $scope.showAutocomplete($scope.results.length > 0);\n      $scope.highlightTag($scope.results[0]);\n    }\n\n    $scope.showAutocomplete = function(show) {\n      $scope.formData.showAutocomplete = show;\n\n      $timeout(function(){\n        componentManager.setSize(\"content\", \"100%\", document.documentElement.scrollHeight);\n      })\n    }\n\n    $scope.selectTag = function(tag) {\n      var comps = tag.content.title.split(delimitter);\n      for(var index = 1; index < comps.length + 1; index++) {\n        var tagName = comps.slice(0, index).join(delimitter);\n        var _tag = $scope.tags.filter(function(candidate){\n          return candidate.content.title === tagName;\n        })[0]\n\n        componentManager.associateItem(_tag);\n      }\n\n      $scope.showAutocomplete(false);\n      $scope.formData.input = \"\";\n      $scope.highlightedTag = null;\n    }\n\n    $scope.removeActiveTag = function(tag) {\n      componentManager.deassociateItem(tag);\n    }\n\n    componentManager.streamItems(function(newTags) {\n      $timeout(function(){\n        var allTags = $scope.tags || [];\n        for(var tag of newTags) {\n          var existing = allTags.filter(function(tagCandidate){\n            return tagCandidate.uuid === tag.uuid;\n          })[0];\n          if(existing) {\n            Object.assign(existing, tag);\n          } else {\n            allTags.push(tag);\n          }\n        }\n        $scope.tags = allTags;\n      })\n\n    }.bind(this));\n\n    componentManager.streamContextItem(function(item){\n      $timeout(function(){\n        var tags = $scope.tags.filter(function(tag){\n          var matchingReference = item.content.references.filter(function(ref){\n            return ref.uuid === tag.uuid\n          })[0];\n          return matchingReference;\n        })\n\n        $scope.activeTags = tags.sort(function(a, b){\n          return a.content.title > b.content.title;\n        })\n      })\n    })\n\n    $scope.highlightTag = function(tag) {\n      $scope.highlightedTag = tag;\n    }\n\n    $scope.highlightNextResult = function() {\n      if(!$scope.results) {\n        return;\n      }\n      var index = $scope.results.indexOf($scope.highlightedTag);\n      $scope.highlighResultAtIndex(index + 1);\n    }\n\n    $scope.highlightPreviousResult = function() {\n      if(!$scope.results) {\n        return;\n      }\n      var index = $scope.results.indexOf($scope.highlightedTag);\n      index--;\n      if(index < 0) {\n        index = $scope.results.length - 1;\n      }\n      $scope.highlighResultAtIndex(index);\n    }\n\n    $scope.highlighResultAtIndex = function(index) {\n      $scope.highlightTag($scope.results[index % $scope.results.length]);\n    }\n\n    $scope.onEnter = function() {\n      if($scope.highlightedTag) {\n        $scope.selectTag($scope.highlightedTag);\n      } else if($scope.formData.input) {\n        componentManager.createItem({content_type: \"Tag\", content: {title: $scope.formData.input}});\n        $scope.formData.input = \"\";\n      }\n    }\n\n    componentManager.setSize(\"container\", \"100%\", defaultHeight);\n\n    document.onkeydown = handleArrowKey;\n\n    function handleArrowKey(e) {\n        e = e || window.event;\n        if (e.keyCode == '38') {\n          // up arrow\n          $timeout(function(){\n            $scope.highlightPreviousResult();\n          })\n        } else if (e.keyCode == '40') {\n          // down arrow\n          $timeout(function(){\n            $scope.highlightNextResult();\n          });\n        }\n    }\n\n  }\n}\n\n// required for firefox\nHomeCtrl.$$ngIsClass = true;\n\nangular.module('app').controller('HomeCtrl', HomeCtrl);\n"]}